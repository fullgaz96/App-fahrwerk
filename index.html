<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üèçÔ∏è Fahrwerksprotokoll & Reifenlager</title>
  <style>
    body { font-family: -apple-system, sans-serif; background: #121212; color: #f0f0f0; padding: 20px; margin: 0; }
    h1, h2 { color: #3a85ff; }
    fieldset { border: 1px solid #444; border-radius: 8px; padding: 15px; margin-bottom: 15px; background: #1e1e1e; }
    legend { font-weight: bold; color: #3a85ff; }
    label { display: block; margin: 10px 0 4px; font-weight: bold; }
    input, select, textarea { width: 100%; padding: 10px; border: 1px solid #444; border-radius: 6px; background: #2d2d2d; color: #f0f0f0; }
    .btn { padding: 14px 20px; font-size: 18px; background: #3a85ff; color: white; border: none; border-radius: 8px; cursor: pointer; width: 100%; margin: 15px 0; }
    .hidden { display: none; }
    #historie { margin-top:20px; padding:15px; background:#1e1e1e; border:1px solid #444; border-radius:8px; }
    .hist-item { margin-bottom:15px; padding:10px; border-bottom:1px solid #444; }
    .hist-item:last-child { border-bottom:none; }
    .hist-head { color:#3a85ff; font-weight:bold; margin-bottom:5px; }
    .hist-data { font-family: monospace; white-space: pre-wrap; font-size: 14px; }
  </style>
</head>
<body>
<h1>üèçÔ∏è Fahrwerksprotokoll & Reifenlager</h1>

<form id="fahrwerkForm">
  <!-- Grunddaten -->
  <fieldset>
    <legend>Grunddaten</legend>
    <label>Motorrad</label>
    <select id="motorrad" required>
      <option value="GSX-R 750">GSX-R 750</option>
      <option value="SV 650">SV 650</option>
      <option value="GS 500E">GS 500E</option>
    </select>
    <label>Strecke</label>
    <select id="strecke" required>
      <option value="">-- w√§hlen --</option>
      <option value="OSL">Oschersleben</option>
      <option value="SAC">Sachsenring</option>
      <option value="STC">Spreewaldring</option>
      <option value="GD">Gros Doelln</option>
      <option value="MST">Most</option>
      <option value="HARZ">Harzring</option>
      <option value="HDBR">Heidbergring</option>
      <option value="BRN">Br√ºnn</option>
      <option value="LSR">Lausitzring</option>
      <option value="TPZ">Tor Pozna≈Ñ</option>
      <option value="custom">nicht dabei</option>
    </select>
    <div id="customContainer" class="hidden">
      <label>Strecke (manuell)</label>
      <input type="text" id="streckeCustom" placeholder="z. B. Hockenheim" />
    </div>
    <label>Session</label>
    <select id="session" required>
      <option value="TR">Training</option>
      <option value="Q">Qualifikation</option>
      <option value="R">Rennen</option>
      <option value="I">Instruktion</option>
    </select>
    <label>Datum</label>
    <input type="date" id="datum" required />
  </fieldset>

  <!-- Fahrwerksdaten (gek√ºrzt f√ºr √úbersicht, Rest bleibt wie bei dir!) -->
  <fieldset>
    <legend>Vorderrad (Gabel)</legend>
    <label>Gabelh√∂he (mm)</label><input type="number" id="gabelHoehe" />
    <label>Federrate (N/mm)</label><input type="number" id="federV" step="0.1" />
    <label>Federvorspannung (mm)</label><input type="number" id="vorspannungV" />
    <label>Druckstufe (Umdr)</label><input type="text" id="druckV" />
    <label>Zugstufe (Umdr)</label><input type="text" id="zugV" />
  </fieldset>

  <fieldset>
    <legend>Hinterrad (Federbein)</legend>
    <label>Heckh√∂he (mm)</label><input type="number" id="heckhoehe" />
    <label>Federvorspannung (mm)</label><input type="number" id="vorspannungH" />
    <label>Federrate (N/mm)</label><input type="number" id="federH" step="0.1" />
    <label>Druckstufe LS/HS</label><input type="text" id="druckH" />
    <label>Zugstufe</label><input type="text" id="zugH" />
  </fieldset>

  <button type="button" class="btn" onclick="saveFahrwerk()">üíæ Fahrwerk speichern</button>
  <input type="file" id="fahrwerkFile" accept=".json" onchange="loadFahrwerk(event)" class="btn" />
</form>

<div id="historie">
  <h2>üìú Historie</h2>
  <div id="historieList"></div>
</div>

<script>
let fahrwerkData = { historie: [] };

document.getElementById("datum").valueAsDate = new Date();

function saveFahrwerk() {
  const f = id => document.getElementById(id)?.value || "-";
  const eintrag = {
    datum: f("datum"),
    motorrad: f("motorrad"),
    strecke: f("strecke") === "custom" ? f("streckeCustom") : f("strecke"),
    session: f("session"),
    gabelHoehe: f("gabelHoehe"),
    federV: f("federV"),
    vorspannungV: f("vorspannungV"),
    druckV: f("druckV"),
    zugV: f("zugV"),
    heckhoehe: f("heckhoehe"),
    vorspannungH: f("vorspannungH"),
    federH: f("federH"),
    druckH: f("druckH"),
    zugH: f("zugH")
  };
  fahrwerkData.historie.push(eintrag);

  const blob = new Blob([JSON.stringify(fahrwerkData,null,2)], {type:"application/json"});
  const a = document.createElement("a");
  const motorradName = eintrag.motorrad.replace(/\s+/g,"_");
  a.href = URL.createObjectURL(blob);
  a.download = `${motorradName}_fahrwerk.json`;
  a.click();

  renderHistorie();
}

function loadFahrwerk(event){
  const file = event.target.files[0];
  if(!file) return;
  const reader = new FileReader();
  reader.onload = e=>{
    try{
      fahrwerkData = JSON.parse(e.target.result);
    }catch{
      alert("Fehler beim Laden");
      return;
    }
    renderHistorie();
  };
  reader.readAsText(file);
}

function renderHistorie(){
  const list = document.getElementById("historieList");
  list.innerHTML = "";
  fahrwerkData.historie.forEach(h=>{
    const div = document.createElement("div");
    div.className = "hist-item";
    div.innerHTML = `
      <div class="hist-head">${h.datum} ‚Äì ${h.motorrad} (${h.session} @ ${h.strecke})</div>
      <div class="hist-data">
        Gabelh√∂he: ${h.gabelHoehe} | Federrate V: ${h.federV} | Vorspannung V: ${h.vorspannungV} | Druck V: ${h.druckV} | Zug V: ${h.zugV}
        \nHeckh√∂he: ${h.heckhoehe} | Federrate H: ${h.federH} | Vorspannung H: ${h.vorspannungH} | Druck H: ${h.druckH} | Zug H: ${h.zugH}
      </div>
    `;
    list.appendChild(div);
  });
}
</script>
</body>
</html>
